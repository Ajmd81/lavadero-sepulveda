<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">

    <!-- MODO OSCURO - Script INLINE para ejecuci칩n inmediata -->
    <script>
        (function () {
            'use strict';
            const darkMode = localStorage.getItem('darkMode') === 'true';
            if (darkMode) {
                document.documentElement.classList.add('dark-theme');
            }
            const fontSize = localStorage.getItem('fontSize') || 'medium';
            document.documentElement.classList.add('font-' + fontSize);
            const compactView = localStorage.getItem('compactView') === 'true';
            if (compactView) {
                document.documentElement.classList.add('compact-view');
            }
        })();
    </script>

    <link rel="stylesheet" th:href="@{/css/admin-menu.css}">
    <link rel="stylesheet" th:href="@{/css/dark-theme.css}">
    <link rel="icon" type="image/png" th:href="@{/images/favicon.png?v=2}">
</head>

<body>
    <!-- Fragmento de men칰 horizontal mejorado -->
    <nav th:fragment="menu" class="admin-navbar">
        <div class="nav-container">
            <div class="logo-container">
                <img th:src="@{/images/Logo.jpg}" alt="Logo Lavadero Sep칰lveda" class="logo-img">
                <div class="logo-text">Lavadero Sep칰lveda</div>
            </div>

            <!-- Bot칩n hamburguesa para m칩vil -->
            <button class="mobile-toggle" id="mobileToggle" onclick="toggleMobileMenu()">
                <span></span>
                <span></span>
                <span></span>
            </button>

            <!-- Men칰 de navegaci칩n -->
            <ul class="nav-menu" id="navMenu">
                <li class="nav-item">
                    <a th:href="@{/admin/listado-citas}" class="nav-link" data-page="listado-citas">
                        <span class="nav-icon">游늶</span>
                        <span>Listado de Citas</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a th:href="@{/admin/estadisticas}" class="nav-link" data-page="estadisticas">
                        <span class="nav-icon">游늵</span>
                        <span>Estad칤sticas</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a th:href="@{/admin/configuracion}" class="nav-link" data-page="configuracion">
                        <span class="nav-icon">丘뙖잺</span>
                        <span>Configuraci칩n</span>
                    </a>
                </li>
            </ul>

            <!-- Usuario y logout -->
            <div class="nav-user">
                <div class="user-info">
                    <span class="user-avatar">A</span>
                    <span class="user-name">admin</span>
                </div>
                <form th:action="@{/admin/logout}" method="post" class="logout-form">
                    <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
                    <button type="submit" class="logout-btn">
                        <span class="logout-icon">游뛁</span>
                        <span>Cerrar Sesi칩n</span>
                    </button>
                </form>
            </div>
        </div>
    </nav>

    <script>
        // Aplicar tema tambi칠n al body cuando est칠 disponible
        (function () {
            function applyThemeToBody() {
                const darkMode = localStorage.getItem('darkMode') === 'true';
                if (darkMode) {
                    document.body.classList.add('dark-theme');
                }
                const fontSize = localStorage.getItem('fontSize') || 'medium';
                document.body.classList.add('font-' + fontSize);
                const compactView = localStorage.getItem('compactView') === 'true';
                if (compactView) {
                    document.body.classList.add('compact-view');
                }
            }

            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', applyThemeToBody);
            } else {
                applyThemeToBody();
            }
        })();

        // Marcar p치gina activa seg칰n la URL actual
        document.addEventListener('DOMContentLoaded', function () {
            const currentPath = window.location.pathname;
            const navLinks = document.querySelectorAll('.nav-link');

            navLinks.forEach(link => {
                const page = link.getAttribute('data-page');
                if (currentPath.includes(page)) {
                    link.classList.add('active');
                }
            });
        });

        // Toggle men칰 m칩vil
        function toggleMobileMenu() {
            const navMenu = document.getElementById('navMenu');
            const mobileToggle = document.getElementById('mobileToggle');
            navMenu.classList.toggle('active');
            mobileToggle.classList.toggle('active');
        }

        // Cerrar men칰 al hacer clic en un enlace (m칩vil)
        document.addEventListener('DOMContentLoaded', function () {
            const navLinks = document.querySelectorAll('.nav-link');
            navLinks.forEach(link => {
                link.addEventListener('click', function () {
                    if (window.innerWidth <= 768) {
                        const navMenu = document.getElementById('navMenu');
                        const mobileToggle = document.getElementById('mobileToggle');
                        navMenu.classList.remove('active');
                        mobileToggle.classList.remove('active');
                    }
                });
            });

            // Cerrar men칰 al cambiar tama침o de ventana
            window.addEventListener('resize', function () {
                if (window.innerWidth > 768) {
                    const navMenu = document.getElementById('navMenu');
                    const mobileToggle = document.getElementById('mobileToggle');
                    navMenu.classList.remove('active');
                    mobileToggle.classList.remove('active');
                }
            });
        });
    </script>
</body>

</html>